<%= render partial: 'bar' %>
<h1><%= @user.user_name%>'s Page</h1>

<h1><%= @user.user_name%>'s Created Puzzles</h1>
<% @user.puzzles.each_with_index do |puzzle, index| %>
  <li class="user-mini-li">


    <%= link_to puzzle_path(puzzle) do %>
    <div id="mini-board<%=index%>" class="board mini_board">
      <%# this next line is the only diffrence between index page %>
      <%= render partial: './puzzles/minigrid' %>
    </div>
    <% end %>
    <%# fetch encrypted string to feed to encrypt function %>
    <div id="mini_encrypt<%=index%>" class="hidden"><%= puzzle.pattern%></div>

    <%# decrypt, put onto each mini board %>
    <script>
    // = require jquery
      var index= <%=index%>;
      var encryptedGrid = $('#mini_encrypt'+index).text();
      var board= $('#mini-board'+index).children().children()
      decryptMini( encryptedGrid, board)
    </script>


    <%= link_to puzzle.user.user_name, user_path(puzzle.user) %>
    <% unless current_user==nil %>
      <%if current_user==@user || current_user.is_admin %>
        <%= link_to "Delete", puzzle_path(puzzle), method: :delete %>   <%= link_to "Edit", edit_puzzle_path(puzzle) %>
      <% end %>
    <%end%>
  </li>
<% end %>

<h1> Puzzles <%= @user.user_name%> has solved</h1>
<% @wins.each_with_index do |win, index| %>
  <% if win.user_id == @user.id %>
      <% @puzzle=Puzzle.find(win.puzzle_id) %>

      <%= link_to puzzle_path(@puzzle) do %>
      <li class="user-mini-li">>
        <div id="mini-board<%=index+1000%>" class="board mini_board">
          <%= render partial: './puzzles/minigrid' %>
          <%= link_to @puzzle.user.user_name, user_path(@puzzle.user) %>
        </div>
      </li>
      <% end %>

      <div id="mini_encrypt<%=index+1000%>" class="hidden"><%= @puzzle.pattern%></div>
      <%# decrypt, put onto each mini board %>
      <script>
      // = require jquery
          var index= <%=index%>;
        var encryptedGrid = $('#mini_encrypt'+(index+1000)).text();
        var board= $('#mini-board'+(index+1000)).children().children()
        decryptMini( encryptedGrid, board)
      </script>
  <% end %>

<% end %>
